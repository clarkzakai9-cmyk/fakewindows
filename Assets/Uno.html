<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>UNO - Zakai Edition</title>
<style>body {
  font-family: sans-serif;
  background: #1e1e1e;
  color: #fff;
  margin: 0;
  padding: 20px;
  text-align: center;
}

h1, h2 {
  margin-bottom: 10px;
}

/* Game Table Layout */
#table {
  display: grid;
  grid-template-areas:
    "top top top"
    "left center right"
    "bottom bottom bottom";
  grid-template-columns: 1fr 2fr 1fr;
  gap: 10px;
  max-width: 1000px;
  margin: auto;
  background: radial-gradient(circle at center, #2e7d32, #1b5e20);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.6);
}

#top    { grid-area: top; }
#left   { grid-area: left; }
#center {
  grid-area: center;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  padding: 10px;
}

#right  { grid-area: right; }
#bottom { grid-area: bottom; }

.opponent, .player {
  text-align: center;
}

.hand {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 8px;
}

/* Card Face Styles */
.card {
  width: 60px;
  height: 90px;
  border-radius: 6px;
  font-weight: bold;
  text-align: center;
  line-height: 90px;
  font-size: 16px;
  cursor: pointer;
  color: white;
  box-shadow: 0 2px 5px rgba(0,0,0,0.4);
}

.red    { background: crimson; }
.green  { background: seagreen; }
.blue   { background: royalblue; }
.yellow { background: gold; color: black; }
.black  { background: black; }

/* Card Back for Opponents */
.card-back {
  width: 60px;
  height: 90px;
  border-radius: 6px;
  background: radial-gradient(circle at center, crimson 20%, #a30000 100%);
  box-shadow: 0 2px 5px rgba(0,0,0,0.4);
  position: relative;
}

.card-back::before {
  content: "UNO";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-15deg);
  font-size: 22px;
  font-weight: bold;
  font-family: Arial Black, sans-serif;
  color: gold;
  text-shadow: 1px 1px 2px black;
}

/* Draw and Discard Piles */
.pile, .draw {
  width: 80px;
  height: 110px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
  border: 2px solid #999;
}

.pile.red    { background: crimson; }
.pile.green  { background: seagreen; }
.pile.blue   { background: royalblue; }
.pile.yellow { background: gold; color: black; }
.pile.black  { background: black; color: white; }

.draw {
  background: radial-gradient(circle at center, crimson 20%, #a30000 100%);
  cursor: pointer;
  color: white;
  position: relative;
}

.draw::before {
  content: "UNO";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-15deg);
  font-size: 24px;
  font-weight: bold;
  font-family: Arial Black, sans-serif;
  color: gold;
  text-shadow: 1px 1px 2px black;
}

/* Animations */
@keyframes card-draw-animation {
  0%   { transform: scale(0.3); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes card-discard-animation {
  0%   { transform: translateY(0) scale(1); opacity: 1; }
  100% { transform: translateY(-40px) rotate(-15deg) scale(0.9); opacity: 0.5; }
}

.card-draw    { animation: card-draw-animation 0.3s ease-out; }
.card-discard { animation: card-discard-animation 0.4s ease-in; }

/* Color Picker */
#color-picker {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background: #222;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px #000;
  display: none;
  z-index: 10;
}

.colorBtn {
  width: 60px;
  height: 60px;
  margin: 10px;
  font-size: 24px;
  border: none;
  border-radius: 50%;
  cursor: pointer;
}

.colorBtn.red    { background: crimson; }
.colorBtn.green  { background: seagreen; }
.colorBtn.blue   { background: royalblue; }
.colorBtn.yellow { background: gold; color: black; }

/* Main Menu */
#main-menu {
  padding: 40px;
  background: #111;
  border-radius: 12px;
  box-shadow: 0 0 20px #000;
  max-width: 400px;
  margin: auto;
}

#player-options button {
  margin: 10px;
  padding: 12px 24px;
  font-size: 18px;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  background: royalblue;
  color: white;
  cursor: pointer;
  transition: transform 0.2s ease;
}

#player-options button:hover {
  transform: scale(1.05);
}
</style>
</head>
<body>
  <div id="main-menu">
    <h2>Welcome to UNO - Zakai Edition</h2>
    <p>Select Number of Players:</p>
    <div id="player-options">
      <button onclick="startGame(2)">2 Players</button>
      <button onclick="startGame(3)">3 Players</button>
      <button onclick="startGame(4)">4 Players</button>
      <button onclick="startGame(6)">6 Players</button>
    </div>
  </div>

  <div id="game-area" style="display: none;">
    <h1>UNO - Zakai Edition</h1>
    <div id="table">
      <div class="opponent" id="top">
        <p>Cards: <span id="count-top">0</span></p>
        <div class="hand" id="hand-top"></div>
      </div>
      <div class="opponent" id="left">
        <p>Cards: <span id="count-left">0</span></p>
        <div class="hand" id="hand-left"></div>
      </div>
<div id="center">
  <div class="pile" id="pile"></div>
  <div class="draw" onclick="drawCard()"></div>
</div>

      <div class="opponent" id="right">
        <p>Cards: <span id="count-right">0</span></p>
        <div class="hand" id="hand-right"></div>
      </div>
      <div class="player" id="bottom">
        <div class="hand" id="player-hand"></div>
      </div>
    </div>

    <div id="color-picker">
      <h3>Choose a Color</h3>
      <button class="colorBtn red" onclick="selectWildColor('red')">‚ù§Ô∏è</button>
      <button class="colorBtn green" onclick="selectWildColor('green')">üíö</button>
      <button class="colorBtn blue" onclick="selectWildColor('blue')">üíô</button>
      <button class="colorBtn yellow" onclick="selectWildColor('yellow')">üíõ</button>
    </div>
  </div>

  <script>let numPlayers = 4;
let deck = [], players = [];
let pile = null, currentPlayer = 0, direction = 1;
let skip = false, drawStack = 0, wildPending = false, wildColor = null;

const COLORS = ["red", "green", "blue", "yellow"];
const VALUES = [...Array(10).keys()].map(String).concat("Skip", "Reverse", "Draw2", "Wild", "Wild4");

function startGame(count) {
  numPlayers = count;
  players = Array.from({ length: numPlayers }, () => []);
  document.getElementById("main-menu").style.display = "none";
  document.getElementById("game-area").style.display = "block";
  createDeck();
  deal();
}

function createDeck() {
  deck = [];
  for (let color of COLORS) {
    for (let val of VALUES) {
      if (["Wild", "Wild4"].includes(val)) continue;
      deck.push({ color, val });
      if (val !== "0") deck.push({ color, val });
    }
  }
  for (let i = 0; i < 4; i++) {
    deck.push({ color: "black", val: "Wild" });
    deck.push({ color: "black", val: "Wild4" });
  }
  deck.sort(() => Math.random() - 0.5);
}

function deal() {
  for (let i = 0; i < 7; i++) {
    for (let p = 0; p < numPlayers; p++) {
      players[p].push(deck.pop());
    }
  }
  pile = deck.pop();
  wildColor = pile.color !== "black" ? pile.color : null;
  updateUI();
}

function updateUI() {
  const p = document.getElementById("pile");
  p.textContent = `${wildColor?.toUpperCase() || pile.color.toUpperCase()} ${pile.val}`;
  p.className = `pile ${wildColor || pile.color}`;

  const hand = document.getElementById("player-hand");
  hand.innerHTML = "";
  players[0].forEach((card, idx) => {
    const c = document.createElement("div");
    c.className = `card ${card.color} card-draw`;
    c.textContent = getIcon(card);
    c.onclick = () => playCard(0, idx);
    hand.appendChild(c);
  });

  renderBacks("hand-top", players[1]?.length || 0);
  renderBacks("hand-left", players[2]?.length || 0);
  renderBacks("hand-right", players[3]?.length || 0);

  document.getElementById("count-top").textContent = players[1]?.length || 0;
  document.getElementById("count-left").textContent = players[2]?.length || 0;
  document.getElementById("count-right").textContent = players[3]?.length || 0;
}

function renderBacks(id, count) {
  const container = document.getElementById(id);
  if (!container) return;
  container.innerHTML = "";
  for (let i = 0; i < count; i++) {
    const cardBack = document.createElement("div");
    cardBack.className = "card-back";
    container.appendChild(cardBack);
  }
}

function getIcon(card) {
  const icons = {
    "Skip": "üö´",
    "Reverse": "üîÅ",
    "Draw2": "‚ûï2",
    "Wild": "üé®",
    "Wild4": "‚ûï4"
  };
  return icons[card.val] || card.val;
}

function canPlay(card) {
  if (wildPending) return false;
  if (drawStack > 0 && !["Draw2", "Wild4"].includes(card.val)) return false;
  return (
    card.color === pile.color ||
    card.val === pile.val ||
    card.color === "black" ||
    (pile.color === "black" && card.color === wildColor)
  );
}

function playCard(pIdx, cIdx) {
  if (pIdx !== 0 || currentPlayer !== 0 || wildPending) return;
  const card = players[0][cIdx];
  if (!canPlay(card)) return;

  const cardEl = document.getElementById("player-hand").children[cIdx];
  cardEl.classList.add("card-discard");

  setTimeout(() => {
    players[0].splice(cIdx, 1);
    pile = card;

    if (card.color === "black") {
      wildPending = true;
      showColorPicker();
    } else {
      applyEffect(card);
      checkWin(0);
      nextTurn();
    }
  }, 400);
}

function applyEffect(card) {
  if (card.val === "Skip") skip = true;
  if (card.val === "Reverse") direction *= -1;
  if (card.val === "Draw2") drawStack += 2;
  if (card.val === "Wild4") drawStack += 4;
  wildColor = card.color !== "black" ? card.color : wildColor;
}

function drawCard() {
  if (currentPlayer === 0 && !wildPending) {
    if (drawStack > 0) {
      for (let i = 0; i < drawStack; i++) {
        players[0].push(deck.pop());
      }
      drawStack = 0;
      nextTurn();
    } else {
      players[0].push(deck.pop());
      updateUI();
    }
  }
}

function showColorPicker() {
  document.getElementById("color-picker").style.display = "block";
}

function selectWildColor(color) {
  wildColor = color;
  wildPending = false;
  document.getElementById("color-picker").style.display = "none";
  applyEffect(pile);
  checkWin(0);
  nextTurn();
}

function nextTurn() {
  currentPlayer = (currentPlayer + (skip ? 2 : 1) * direction + numPlayers) % numPlayers;
  skip = false;

  if (drawStack > 0 && currentPlayer !== 0) {
    for (let i = 0; i < drawStack; i++) {
      players[currentPlayer].push(deck.pop());
    }
    drawStack = 0;
    currentPlayer = (currentPlayer + direction + numPlayers) % numPlayers;
  }

  if (currentPlayer !== 0) {
    setTimeout(() => {
      aiPlay(currentPlayer);
      updateUI();
      nextTurn();
    }, 800);
  } else {
    updateUI();
  }
}

function aiPlay(pIdx) {
  const hand = players[pIdx];
  const idx = hand.findIndex(canPlay);
  if (idx >= 0) {
    const card = hand[idx];
    pile = card;
    hand.splice(idx, 1);
    wildColor = card.color === "black" ? COLORS[Math.floor(Math.random() * 4)] : card.color;
    applyEffect(card);
    checkWin(pIdx);
  } else {
    hand.push(deck.pop());
  }
}

function checkWin(pIdx) {
  if (players[pIdx].length === 0) {
    alert(pIdx === 0 ? "üéâ You win!" : `Player ${pIdx + 1} wins!`);
    location.reload();
  }
}
</script>
</body>
</html>
